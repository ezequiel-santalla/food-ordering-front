<section class="space-y-4">
  @if (isLoading()) {
  <!-- Loading State -->
  <div class="flex flex-col items-center justify-center py-12">
    <span class="loading loading-spinner loading-lg text-primary"></span>
    <p class="text-gray-500 mt-4">Cargando pedidos de la mesa...</p>
  </div>
  }

  @else if (error()) {
  <!-- Error State -->
  <div class="alert alert-error">
    <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
        d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
    <span>{{ error() }}</span>
  </div>
  <button class="btn btn-primary btn-block">
    Reintentar
  </button>
  }

  @else if (orders().length === 0) {
  <!-- Empty State -->
  <div class="bg-white rounded-2xl shadow-lg p-8">
    <div class="flex flex-col items-center justify-center text-center py-8">
      <lucide-icon [img]="Package" [size]="64" class="text-gray-300 mb-4"></lucide-icon>
      <p class="text-gray-500 font-medium text-lg mb-2">No hay pedidos en esta mesa</p>
      <p class="text-sm text-gray-400">Los pedidos de todos los comensales aparecer√°n aqu√≠</p>
    </div>
  </div>
  }

  @else {
  <!-- Orders List -->

  <!-- Table Header Card -->
  <div class="bg-white rounded-2xl shadow-lg overflow-hidden mb-4">
    <div class="bg-gradient-to-r from-primary/20 to-primary/10 px-6 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="bg-primary text-primary-content w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg">
          <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 3h18v18H3z"></path>
            <path d="M3 9h18"></path>
            <path d="M9 21V9"></path>
          </svg>
        </div>
        <div>
          <p class="text-sm text-gray-600 font-medium">Pedidos de la</p>
          <p class="text-2xl font-bold text-gray-800">Mesa {{ tableNumber() }}</p>
        </div>
      </div>

      <div class="text-right">
        <p class="text-sm text-gray-600">Total de pedidos</p>
        <p class="text-3xl font-bold text-primary">{{ orders().length }}</p>
      </div>
    </div>

    <!-- Table Summary -->
    <div class="px-6 py-4 bg-gray-50 border-t border-gray-200">
      <div class="flex items-center justify-between">
        <span class="text-sm text-gray-600">Total acumulado de la mesa</span>
        <span class="text-xl font-bold text-gray-800">
          {{ getTotalTable() | currency:'ARS' }}
        </span>
      </div>
    </div>
  </div>

  <!-- Orders Cards -->
  @for (order of orders(); track order.publicId) {
  <div class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow">

    <!-- Order Header -->
    <div class="bg-gradient-to-r from-primary/10 to-primary/5 px-6 py-4 border-b border-gray-100">
      <div class="flex items-center justify-between mb-2">
        <div class="flex items-center gap-3">
          <div
            class="bg-primary text-primary-content w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg shadow-lg">
            #{{ order.orderNumber }}
          </div>
          <div>
            <p class="font-bold text-gray-800 text-lg">Orden #{{ order.orderNumber }}</p>
            <p class="text-sm text-gray-600">üë§ {{ order.clientAlias }}</p>
          </div>
        </div>

        <div class="text-right">
          <div class="flex items-center gap-2 justify-end mb-1">
            <span [class]="'badge badge-lg gap-1 ' + getStatusBadgeClass(order.status)">
              <lucide-icon [img]="getStatusIcon(order.status)" [size]="14"></lucide-icon>
              {{ getStatusText(order.status) }}
            </span>
          </div>
          <p class="text-xl font-bold text-gray-800">
            {{ order.totalPrice | currency:'ARS' }}
          </p>
        </div>
      </div>
    </div>

    <!-- Order Details -->
    <div class="px-6 py-4">

      <!-- Products -->
      <div class="space-y-3 mb-4">
        @for (detail of order.orderDetails; track detail.id) {
        <div class="flex items-start justify-between py-3 border-b border-gray-100 last:border-0">
          <div class="flex-1 min-w-0">
            <div class="flex items-center gap-2 mb-1">
              <span class="font-semibold text-gray-800">
                {{ detail.quantity }}x
              </span>
              <span class="font-medium text-gray-700">
                {{ detail.productName }}
              </span>
            </div>

            <p class="text-xs text-gray-500 mb-1">
              {{ detail.category }}
            </p>

            @if (detail.specialInstructions) {
            <p class="text-sm text-gray-600 italic mt-1">
              üóíÔ∏è {{ detail.specialInstructions }}
            </p>
            }
          </div>

          <div class="text-right ml-4">
            <p class="text-sm text-gray-500">
              {{ detail.unitPrice | currency:'ARS' }} c/u
            </p>
            <p class="font-semibold text-gray-800">
              {{ detail.subtotal | currency:'ARS' }}
            </p>
          </div>
        </div>
        }
      </div>

      <!-- Special Requirements -->
      @if (order.specialRequirements) {
      <div class="bg-amber-50 border border-amber-200 rounded-lg p-3 mt-4">
        <p class="text-xs font-semibold text-amber-800 mb-1">
          üìã Requisitos especiales:
        </p>
        <p class="text-sm text-amber-700">
          {{ order.specialRequirements }}
        </p>
      </div>
      }
    </div>

    <!-- Order Footer -->
    <div class="bg-gray-50 px-6 py-3 border-t border-gray-200">
      <div class="flex items-center justify-between text-sm">
        <span class="text-gray-600">
          {{ order.orderDetails.length }} producto(s)
        </span>
        <span class="font-bold text-gray-800">
          Total: {{ order.totalPrice | currency:'ARS' }}
        </span>
      </div>
    </div>

  </div>
  }
  }

</section>
